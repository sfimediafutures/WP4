<!DOCTYPE html>
<html>
<head>
  <title>VideoPositioning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">


  <script src="https://mcorp.no/lib/mcorp-2.0.js"></script>
  <script src="https://mcorp.no/lib/mediasync.js"></script>
  <script src="https://webtiming.github.io/timingsrc/lib/timingsrc-v2.js"></script>

  <script src="app.js"></script>

  <script>

    window.addEventListener("resize", function() {
      app.resize();
    });

  </script>

  <style>
    body {
      height: 100%;
      width: 100%;
      margin: 0px;
    }
    .videocontainer {
      position: fixed;
      margin: 0px;
      width: 100%;
      height: 100%;
      overflow: hidden;
      border: green 2px solid;
    }

    .videocontainer video {
      position: absolute;
    }

    .rightalign {
      text-align: right;
    }

    .subtitle {
      position: absolute;
      bottom: 10px;
      left: 10px;
      z-index: 20;
      background: rgba(0,0,0,0.5);
      color: white;
      font-size: 1.7em;
    }

    .subtitle.rightalign {
      right: 10px;
    }

    .overlay {
      position: absolute;
      bottom: 50px;
      left 10px;
      padding: 2%;
      width: 96%;
      background: green;
      font-size: 1.5em;
      z-index: 10;
    }

    .overlay .name {
      font-weight: bold;
      font-size: 1.5em;
    }

    .overlay .title {
      font-weight: italic;
      font-size: 1em;
    }

    .hidden {
      display: none;
    }

  </style>


</head>
<body>

<div class="videocontainer">

<div class="subtitle hidden"></div>
<div class="overlay hidden">
  <div class="name">
  </div>
  <div class="title">
  </div>
</div>
</div>

<script>

  app.sequencer.on("change", function(evt) {

    let align = function(element, align) {
      console.log("Align", element, align);
      if (!element) return;
      if (align === "right") {
        element.classList.add("rightalign")
      } else {
        element.classList.remove("rightalign")
      }
    };

    let itm = evt.data;
    console.log("CHANGE", itm);
    if (itm.pos) {
      let target = document.querySelector(itm.target + " video");
      target.pos = itm.pos;
      app.resize(document.querySelector(itm.target));
    }

    if (itm.text) {
      align(app.set_subtitle(itm.text), itm.align);
    }

    if (itm.overlay) {
      align(app.set_overlay(itm.overlay), itm.align);
    }
  });


  app.sequencer.on("remove", function(evt) {
    let itm = evt.data;
    if (itm.text) {
      app.set_subtitle("");;
    }
    if (itm.overlay) {
      app.set_overlay();
    }
  });



  app.load("StaticNisse.js?ts=" + new Date().getTime() , ".videocontainer");
</script>
</body>
</html>